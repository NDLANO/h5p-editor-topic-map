"use strict";(self.webpackChunkh5p_editor_topic_map=self.webpackChunkh5p_editor_topic_map||[]).push([[963],{"./src/types/ArrowType.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>ArrowType});var ArrowType=function(ArrowType){return ArrowType.Directional="0",ArrowType.BiDirectional="1",ArrowType.NonDirectional="2",ArrowType}({})},"./src/utils/arrow.utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{JZ:()=>yAdjustmentStart,L_:()=>findBoxEdgePosition,_b:()=>xAdjustmentStart,fj:()=>yAdjustmentEnd,hi:()=>updateArrowType,iO:()=>updateArrowLabels,id:()=>getLabel,nr:()=>adjustArrowEndPosition,vX:()=>adjustArrowStartPosition,w3:()=>xAdjustmentEnd});var _arrowLabelJoins,_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/types/ArrowType.ts"),_grid_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/grid.utils.ts");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var arrowLabelJoins=(_defineProperty(_arrowLabelJoins={},_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.BiDirectional,"↔"),_defineProperty(_arrowLabelJoins,_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.Directional,"⟶"),_defineProperty(_arrowLabelJoins,_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.NonDirectional,"―"),_arrowLabelJoins),getLabel=function getLabel(startItemId,endItemId,arrowType,items){var startItem=(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.i$)(startItemId,items),endItem=(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.i$)(endItemId,items);if(!startItem)throw new Error("Start item not found");if(!endItem)throw new Error("End item not found");return"".concat(startItem.label," ").concat(arrowLabelJoins[arrowType]," ").concat(endItem.label)},updateArrowLabels=function updateArrowLabels(items,topicMapItems){return items.map((function(item){var startItem=(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.i$)(item.startElementId,topicMapItems),endItem=(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.i$)(item.endElementId,topicMapItems);if(!startItem||!endItem)return item;var label=getLabel(startItem.id,endItem.id,item.arrowType,topicMapItems);return _objectSpread(_objectSpread({},item),{},{label})}))},calculateIsHorizontal=function calculateIsHorizontal(startPosition,endPosition){return Math.abs(startPosition.x-endPosition.x)>Math.abs(startPosition.y-endPosition.y)},xAdjustmentStart=function xAdjustmentStart(item,isHorizontal){if(item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.BiDirectional){if(isHorizontal&&item.startGridPosition.x<=item.endGridPosition.x)return.5;if(isHorizontal)return-1.5}return-.5},yAdjustmentStart=function yAdjustmentStart(item,isHorizontal){if(item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.BiDirectional){if(!isHorizontal&&item.startGridPosition.y<=item.endGridPosition.y)return.5;if(!isHorizontal)return-1.75}return-.5},xAdjustmentEnd=function xAdjustmentEnd(item){var _item$breakpoints$sli,_item$breakpoints,sourcePosition=null!==(_item$breakpoints$sli=null===(_item$breakpoints=item.breakpoints)||void 0===_item$breakpoints?void 0:_item$breakpoints.slice(-1)[0])&&void 0!==_item$breakpoints$sli?_item$breakpoints$sli:item.startGridPosition,isHorizontal=calculateIsHorizontal(sourcePosition,item.endGridPosition);return item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.Directional||item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.BiDirectional?isHorizontal&&sourcePosition.x<=item.endGridPosition.x?-1.75:isHorizontal?.5:-.5:item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.NonDirectional?(isHorizontal&&(sourcePosition.x,item.endGridPosition.x),-.5):0},yAdjustmentEnd=function yAdjustmentEnd(item){var _item$breakpoints$sli2,_item$breakpoints2,sourcePosition=null!==(_item$breakpoints$sli2=null===(_item$breakpoints2=item.breakpoints)||void 0===_item$breakpoints2?void 0:_item$breakpoints2.slice(-1)[0])&&void 0!==_item$breakpoints$sli2?_item$breakpoints$sli2:item.startGridPosition,isHorizontal=calculateIsHorizontal(sourcePosition,item.endGridPosition);return item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.Directional||item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.BiDirectional?isHorizontal?-.5:sourcePosition.y<=item.endGridPosition.y?-1.75:.5:item.arrowType===_types_ArrowType__WEBPACK_IMPORTED_MODULE_0__.n.NonDirectional?(!isHorizontal&&(sourcePosition.y,item.endGridPosition.y),-.5):0},adjustArrowStartPosition=function adjustArrowStartPosition(startPosition,endPosition,arrowType){var isHorizontal=calculateIsHorizontal(startPosition,endPosition);return{x:startPosition.x+xAdjustmentStart({arrowType,startGridPosition:startPosition,endGridPosition:endPosition},isHorizontal),y:startPosition.y+yAdjustmentStart({arrowType,startGridPosition:startPosition,endGridPosition:endPosition},isHorizontal)}},adjustArrowEndPosition=function adjustArrowEndPosition(startPosition,endPosition,arrowType){return{x:endPosition.x+xAdjustmentEnd({arrowType,startGridPosition:startPosition,endGridPosition:endPosition,breakpoints:[]}),y:endPosition.y+yAdjustmentEnd({arrowType,startGridPosition:startPosition,endGridPosition:endPosition,breakpoints:[]})}},updateArrowType=function updateArrowType(items,updatedItem,arrowType,topicMapItems,dimensions){return items.map((function(item){if(!(item.id===updatedItem.id))return item;var label=getLabel(item.startElementId,item.endElementId,arrowType,topicMapItems);return _objectSpread(_objectSpread({},item),{},{arrowType,label,startPosition:(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.FS)(adjustArrowStartPosition(item.startGridPosition,item.endGridPosition,arrowType),dimensions.numberOfColumns,dimensions.numberOfRows),endPosition:(0,_grid_utils__WEBPACK_IMPORTED_MODULE_1__.FS)(adjustArrowEndPosition(item.startGridPosition,item.endGridPosition,arrowType),dimensions.numberOfColumns,dimensions.numberOfRows)})}))},findBoxEdgePosition=function findBoxEdgePosition(sourcePosition,gridPosition,cellsOfItem,numberOfColumns){if(calculateIsHorizontal(sourcePosition,gridPosition)){if(sourcePosition.x<gridPosition.x){var _newx=cellsOfItem.sort((function(a,b){return a.x-b.x}))[0];return{y:gridPosition.y,x:_newx.index%numberOfColumns+1}}var newx=cellsOfItem.sort((function(a,b){return b.x-a.x}))[0],newxPosition={y:Math.floor(newx.index/numberOfColumns)+1,x:newx.index%numberOfColumns+1};return{y:gridPosition.y,x:newxPosition.x}}if(sourcePosition.y<gridPosition.y){var _newy=cellsOfItem.sort((function(a,b){return a.y-b.y}))[0],_newyPosition={y:Math.floor(_newy.index/numberOfColumns)+1,x:_newy.index%numberOfColumns+1};return{x:gridPosition.x,y:_newyPosition.y}}var newy=cellsOfItem.sort((function(a,b){return b.y-a.y}))[0],newyPosition={y:Math.floor(newy.index/numberOfColumns)+1,x:newy.index%numberOfColumns+1};return{x:gridPosition.x,y:newyPosition.y}}},"./src/utils/grid.utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{kl:()=>calculatePosition,uk:()=>checkIfRightSideOfGrid,i6:()=>createArrowItem,zj:()=>createTopicMapItem,Z2:()=>findConnectedArrows,y8:()=>findHeightPercentage,i$:()=>findItem,uf:()=>findOccupiedCells,Ow:()=>findWidthPercentage,FS:()=>gridToPercentage,A0:()=>isDraggingLeft,bP:()=>isDraggingUp,o2:()=>mapTopicMapItemToElement,gY:()=>minimumSizeReached,vN:()=>positionIsFree,Ot:()=>resizeItems,U8:()=>scaleItemLength,$G:()=>updateItem});var lodash_intersectionby=__webpack_require__("./node_modules/lodash.intersectionby/index.js"),lodash_intersectionby_default=__webpack_require__.n(lodash_intersectionby);function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return grid_utils_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||grid_utils_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function grid_utils_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return grid_utils_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?grid_utils_arrayLikeToArray(o,minLen):void 0}}function grid_utils_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var resizeItems=function resizeItems(items,scaleFactor){return items.map((function(item){return function resizeItem(item,scaleFactor){return _objectSpread(_objectSpread({},item),{},{heightPercentage:item.heightPercentage*scaleFactor,widthPercentage:item.widthPercentage*scaleFactor,xPercentagePosition:item.xPercentagePosition*scaleFactor,yPercentagePosition:item.yPercentagePosition*scaleFactor})}(item,scaleFactor)}))},calculateXPercentage=function calculateXPercentage(xPx,width){return xPx/width*100},calculateYPercentage=function calculateYPercentage(yPx,height){return yPx/height*100},updateItem=function updateItem(items,updatedItem,width,height,_ref){var newPosition=_ref.newPosition,newSize=_ref.newSize;return items.map((function(item){if(!(item.id===updatedItem.id))return item;var newItem=_objectSpread({},item);return newPosition&&(newItem.xPercentagePosition=calculateXPercentage(newPosition.x,width),newItem.yPercentagePosition=calculateYPercentage(newPosition.y,height)),newSize&&(newItem.widthPercentage=calculateXPercentage(newSize.width,width),newItem.heightPercentage=calculateYPercentage(newSize.height,height)),newItem}))},findCellsElementOccupies=function findCellsElementOccupies(_ref2,gridWidth,gridHeight,gapSize,cellSize){var id=_ref2.id,type=_ref2.type,position=_ref2.position,size=_ref2.size,allCells=function getAllCells(gridWidth,gridHeight,gapSize,cellSize){for(var cells=[],stepSize=gapSize+cellSize,currentIndex=0,y=0;y<gridHeight;y+=stepSize)for(var x=0;x<gridWidth;x+=stepSize)cells.push({x,y,index:currentIndex}),currentIndex+=1;return cells}(gridWidth,gridHeight,gapSize,cellSize);return allCells.filter((function(cell){return function cellIsOccupiedByElement(elementPosition,elementSize,cellPosition){return cellPosition.x>=elementPosition.x-5&&cellPosition.x<=elementPosition.x+elementSize.width&&cellPosition.y>=elementPosition.y-5&&cellPosition.y<=elementPosition.y+elementSize.height}(position,size,cell)})).map((function(_ref3){var x=_ref3.x,y=_ref3.y,index=_ref3.index;return{occupiedById:id,occupiedByType:type,x,y,index}}))},findOccupiedCells=function findOccupiedCells(elements,gridWidth,gridHeight,gapSize,cellSize){var _step,occupiedCells=[],_iterator=function grid_utils_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=grid_utils_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}(elements);try{for(_iterator.s();!(_step=_iterator.n()).done;){var element=_step.value;occupiedCells.push.apply(occupiedCells,_toConsumableArray(findCellsElementOccupies(element,gridWidth,gridHeight,gapSize,cellSize)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}return occupiedCells},scaleItemLength=function scaleItemLength(percentage,length,cellSize){var newL=length*percentage/100;return newL>cellSize?newL:cellSize},calculatePosition=function calculatePosition(percentage,length){return length*percentage/100},minimumSizeReached=function minimumSizeReached(xPercentage,gridWidth,yPercentage,gridHeight){return gridWidth*xPercentage/100<0||gridHeight*yPercentage/100<0},mapTopicMapItemToElement=function mapTopicMapItemToElement(item,gridSize,cellSize){return{id:item.id,type:"item",position:{x:calculatePosition(item.xPercentagePosition,gridSize.width),y:calculatePosition(item.yPercentagePosition,gridSize.height)},size:{width:scaleItemLength(item.widthPercentage,gridSize.width,cellSize),height:scaleItemLength(item.heightPercentage,gridSize.height,cellSize)}}},positionIsFree=function positionIsFree(newPosition,elementId,elementSize,gridSize,gapSize,cellSize,occupiedCells){var cellsThisElementWillOccupy=findCellsElementOccupies({id:elementId,type:"item",position:newPosition,size:elementSize},gridSize.width,gridSize.height,gapSize,cellSize);return!function arraysHaveSomeOverlap(arr1,arr2){return lodash_intersectionby_default()(arr1,arr2,"index").length>0}(occupiedCells.filter((function(cell){return cell.occupiedById!==elementId})),cellsThisElementWillOccupy)},isDraggingLeft=function isDraggingLeft(indicatorIndex,boxStartPosition,numberOfColumns){return boxStartPosition%numberOfColumns>=indicatorIndex%numberOfColumns},isDraggingUp=function isDraggingUp(indicatorIndex,boxStartPosition,numberOfColumns,numberOfRows){return Math.floor(boxStartPosition/numberOfColumns)/numberOfRows*100>=Math.floor(indicatorIndex/numberOfColumns)/numberOfRows*100},findWidthPercentage=function findWidthPercentage(onlyScaleVertically,leftHandle,dragLeft,existingItem,xPercentagePosition,xEndPercentagePosition){return onlyScaleVertically?existingItem.widthPercentage:leftHandle&&!dragLeft?existingItem.widthPercentage-(xPercentagePosition-existingItem.xPercentagePosition):leftHandle&&dragLeft?existingItem.widthPercentage+(existingItem.xPercentagePosition-xPercentagePosition):xEndPercentagePosition-xPercentagePosition},findHeightPercentage=function findHeightPercentage(onlyScaleHorizontally,topHandle,dragUp,existingItem,yPercentagePosition,yEndPercentagePosition){return onlyScaleHorizontally?existingItem.heightPercentage:topHandle&&dragUp?existingItem.heightPercentage+(existingItem.yPercentagePosition-yPercentagePosition):topHandle&&!dragUp?existingItem.heightPercentage-(yPercentagePosition-existingItem.yPercentagePosition):yEndPercentagePosition-yPercentagePosition},createTopicMapItem=function createTopicMapItem(){return{id:crypto.randomUUID(),xPercentagePosition:0,yPercentagePosition:0,widthPercentage:0,heightPercentage:0,topicImage:void 0,label:"",description:""}},createArrowItem=function createArrowItem(startId,endId,label,arrowType,startPosition,endPosition,startGridPosition,endGridPosition,breakpoints,relativeBreakpoints){return{id:crypto.randomUUID(),label,arrowType,description:"",startElementId:startId,endElementId:endId,startPosition,endPosition,startGridPosition,endGridPosition,breakpoints,relativeBreakpoints}},findItem=function findItem(id,items){var _items$find;return id&&null!==(_items$find=items.find((function(item){return item.id===id})))&&void 0!==_items$find?_items$find:null},checkIfRightSideOfGrid=function checkIfRightSideOfGrid(xPosition,gridWidth){return xPosition>gridWidth/2},findConnectedArrows=function findConnectedArrows(itemId,arrows){return arrows.filter((function(arrow){return[arrow.startElementId,arrow.endElementId].includes(itemId)}))},gridToPercentage=function gridToPercentage(gridPosition,numberOfColumns,numberOfRows){return{x:gridPosition.x/numberOfColumns*100,y:gridPosition.y/numberOfRows*100}}}}]);