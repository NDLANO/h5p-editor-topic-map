"use strict";(self.webpackChunkh5p_editor_topic_map=self.webpackChunkh5p_editor_topic_map||[]).push([[232],{"./src/components/ArrowItemForm/ArrowItemForm.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>ArrowItemForm});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_utils_H5P_form_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/H5P/form.utils.ts"),_SemanticsForm_SemanticsForm__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/components/SemanticsForm/SemanticsForm.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ArrowItemForm=function ArrowItemForm(_ref){var semantics=_ref.semantics,params=_ref.params,parent=_ref.parent,itemId=_ref.itemId,onSave=_ref.onSave,_React$useState2=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),arrowItemField=_React$useState2[0],setArrowItemField=_React$useState2[1],_React$useState4=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),formParams=_React$useState4[0],setFormParams=_React$useState4[1];react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){var field=(0,_utils_H5P_form_utils__WEBPACK_IMPORTED_MODULE_1__.RU)(semantics);setArrowItemField(field),params.arrowItems&&setFormParams(_objectSpread(_objectSpread({},params),{},{arrowItems:params.arrowItems.filter((function(item){return item.id===itemId}))}))}),[itemId,params,semantics]);var onUpdate=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(newParams){var _params$arrowItems$ma,_params$arrowItems;if(newParams.arrowItems){var updatedItem=newParams.arrowItems[0],updatedItems=null!==(_params$arrowItems$ma=null===(_params$arrowItems=params.arrowItems)||void 0===_params$arrowItems?void 0:_params$arrowItems.map((function(item){return item.id===updatedItem.id?updatedItem:item})))&&void 0!==_params$arrowItems$ma?_params$arrowItems$ma:[];onSave(_objectSpread(_objectSpread({},newParams),{},{arrowItems:updatedItems}))}}),[onSave,params.arrowItems]);return formParams&&arrowItemField?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_SemanticsForm_SemanticsForm__WEBPACK_IMPORTED_MODULE_2__.G,{fields:[arrowItemField],params:formParams,parent,onSave:onUpdate,formClassName:"arrow-item-form"}):null};try{ArrowItemForm.displayName="ArrowItemForm",ArrowItemForm.__docgenInfo={description:"",displayName:"ArrowItemForm",props:{semantics:{defaultValue:null,description:"",name:"semantics",required:!0,type:{name:'H5PFieldCommon & H5PFieldWidgetExtension & { type: "group" | H5PFieldType.Group; widget?: string | undefined; fields: H5PField[]; isSubContent?: boolean | undefined; expanded?: boolean | undefined; }'}},params:{defaultValue:null,description:"",name:"params",required:!0,type:{name:"Params"}},parent:{defaultValue:null,description:"",name:"parent",required:!0,type:{name:"H5PForm"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(params: Params) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ArrowItemForm/ArrowItemForm.tsx#ArrowItemForm"]={docgenInfo:ArrowItemForm.__docgenInfo,name:"ArrowItemForm",path:"src/components/ArrowItemForm/ArrowItemForm.tsx#ArrowItemForm"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/MapEditorView/MapEditorView.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>MapEditorView});var h5p_utils_es=__webpack_require__("./node_modules/h5p-utils/dist/h5p-utils.es.js"),react=__webpack_require__("./node_modules/react/index.js"),H5P_util=__webpack_require__("./src/H5P/H5P.util.ts"),arrow_utils=__webpack_require__("./src/utils/arrow.utils.ts"),grid_utils=__webpack_require__("./src/utils/grid.utils.ts"),form_utils=__webpack_require__("./src/utils/H5P/form.utils.ts"),ArrowItemForm=__webpack_require__("./src/components/ArrowItemForm/ArrowItemForm.tsx"),Dialog=__webpack_require__("./src/components/Dialog/Dialog.tsx"),Grid=__webpack_require__("./src/components/Grid/Grid.tsx"),Toolbar=__webpack_require__("./src/components/Toolbar/Toolbar.tsx"),TopicMapItemForm=__webpack_require__("./src/components/TopicMapItemForm/TopicMapItemForm.tsx");const MapEditorView_module_mapEditorView="MapEditorView-module__mapEditorView--Ad3Vt",MapEditorView_module_gridBorder="MapEditorView-module__gridBorder--UVJss",MapEditorView_module_backgroundImage="MapEditorView-module__backgroundImage--IOH6l",MapEditorView_module_deleteConfirmationPositive="MapEditorView-module__deleteConfirmationPositive--vz23N",MapEditorView_module_deleteConfirmationNegative="MapEditorView-module__deleteConfirmationNegative--q_Mwh",MapEditorView_module_deleteConfirmationButtons="MapEditorView-module__deleteConfirmationButtons--JTBSe";var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MapEditorView=function MapEditorView(_ref){var _params$topicMapItems,_params$arrowItems,_params$gridBackgroun,_params$gridBackgroun2,gapSize=_ref.gapSize,numberOfColumns=_ref.numberOfColumns,numberOfRows=_ref.numberOfRows,params=_ref.params,parent=_ref.parent,semantics=_ref.semantics,setParams=_ref.setParams,columns=null!=numberOfColumns?numberOfColumns:31,rows=null!=numberOfRows?numberOfRows:19,_useState2=_slicedToArray((0,react.useState)(null),2),activeTool=_useState2[0],setActiveTool=_useState2[1],_useState4=_slicedToArray((0,react.useState)(null!==(_params$topicMapItems=params.topicMapItems)&&void 0!==_params$topicMapItems?_params$topicMapItems:[]),2),gridItems=_useState4[0],setGridItems=_useState4[1],_useState6=_slicedToArray((0,react.useState)(null!==(_params$arrowItems=params.arrowItems)&&void 0!==_params$arrowItems?_params$arrowItems:[]),2),arrowItems=_useState6[0],setArrowItems=_useState6[1],_useState8=_slicedToArray((0,react.useState)(null),2),editedItem=_useState8[0],setEditedItem=_useState8[1],_useState10=_slicedToArray((0,react.useState)(null),2),deletedItem=_useState10[0],setDeletedItem=_useState10[1],_useState12=_slicedToArray((0,react.useState)(null),2),selectedItem=_useState12[0],setSelectedItem=_useState12[1],_useState14=_slicedToArray((0,react.useState)(gridItems.length),2),currentItemsLength=_useState14[0],setCurrentItemsLength=_useState14[1],_useState16=_slicedToArray((0,react.useState)(null),2),editedArrow=_useState16[0],setEditedArrow=_useState16[1],_useState18=_slicedToArray((0,react.useState)(!1),2),showDeleteConfirmationDialog=_useState18[0],setShowDeleteConfirmationDialog=_useState18[1],updateGrid=react.useRef((function(newItems){return updateGrid.current(newItems)})),setActive=function setActive(newValue){setActiveTool(newValue)},updateGridDimensions=react.useCallback((function(newGrid){setParams({grid:newGrid})}),[setParams]),updateArrows=react.useCallback((function(items){setParams({arrowItems:items}),setArrowItems(items)}),[setParams]),updateItems=react.useCallback((function(items){if(arrowItems.length>0){var updatedArrows=(0,arrow_utils.iO)(arrowItems,items);updateArrows(updatedArrows),setArrowItems(updatedArrows)}setParams({topicMapItems:items}),setGridItems(items),updateGrid.current(items)}),[arrowItems,setParams,updateArrows]),openDeleteDialogue=react.useCallback((function(itemId){setDeletedItem(itemId),setShowDeleteConfirmationDialog(!0)}),[]),deleteArrow=react.useCallback((function(id){var newItems=arrowItems.filter((function(item){return item.id!==id}));updateArrows(newItems),setArrowItems(newItems)}),[arrowItems,updateArrows]),deleteItem=react.useCallback((function(){var newItems=gridItems.filter((function(item){return item.id!==deletedItem}));(0,grid_utils.Z2)(null!=deletedItem?deletedItem:"",arrowItems).forEach((function(item){return deleteArrow(item.id)})),updateItems(newItems),setGridItems(newItems),updateGrid.current(newItems),setShowDeleteConfirmationDialog(!1),setSelectedItem(null),setCurrentItemsLength(newItems.length)}),[arrowItems,deleteArrow,deletedItem,gridItems,updateItems]),denyDeletion=react.useCallback((function(){setShowDeleteConfirmationDialog(!1),setSelectedItem(null)}),[]),topicMapItemFormDialogTitle=(0,H5P_util.t)("map-editor-view_item-dialog-title"),backgroundImageField=react.useMemo((function(){var bgImgField=(0,form_utils.x4)(semantics);if(!bgImgField)throw new Error("Background image field not found. Was it removed from semantics, or did its name change?");return bgImgField}),[semantics]),backgroundImage=null!==(_params$gridBackgroun=params.gridBackgroundImage)&&void 0!==_params$gridBackgroun&&_params$gridBackgroun.path?"url(".concat((0,h5p_utils_es.Jn)(null===(_params$gridBackgroun2=params.gridBackgroundImage)||void 0===_params$gridBackgroun2?void 0:_params$gridBackgroun2.path),")"):void 0;return(0,jsx_runtime.jsxs)("div",{className:MapEditorView_module_mapEditorView,children:[(0,jsx_runtime.jsx)(Toolbar.o,{setActiveTool:setActive,activeTool,isArrowButtonDisabled:gridItems.length<2,setParams,params,parent,backgroundImageField}),(0,jsx_runtime.jsxs)("div",{className:"".concat(MapEditorView_module_gridBorder," ").concat(backgroundImage?MapEditorView_module_backgroundImage:""),style:{backgroundImage},children:[(0,jsx_runtime.jsx)(Grid.r,{numberOfColumns:columns,numberOfRows:rows,initialItems:gridItems,updateItems,initialArrowItems:arrowItems,updateArrowItems:updateArrows,updateGridDimensions,gapSize:null!=gapSize?gapSize:4,setActiveTool:setActive,activeTool,setEditedItem,setEditedArrow,setSelectedItem,selectedItem,openDeleteDialogue,updateGrid,currentItemsLength,setCurrentItemsLength}),(0,jsx_runtime.jsx)(Dialog.V,{isOpen:showDeleteConfirmationDialog,title:(0,H5P_util.t)("draggable_delete-confirmation"),onOpenChange:function onOpenChange(isOpen){isOpen||(setDeletedItem(null),denyDeletion())},size:"medium",children:(0,jsx_runtime.jsxs)("div",{className:MapEditorView_module_deleteConfirmationButtons,children:[(0,jsx_runtime.jsx)("button",{type:"button",className:MapEditorView_module_deleteConfirmationPositive,onClick:deleteItem,children:(0,H5P_util.t)("draggable_delete-positive")}),(0,jsx_runtime.jsx)("button",{type:"button",className:MapEditorView_module_deleteConfirmationNegative,onClick:denyDeletion,children:(0,H5P_util.t)("draggable_delete-negative")})]})}),(0,jsx_runtime.jsxs)(Dialog.V,{isOpen:Boolean(semantics&&(editedItem||editedArrow)),title:topicMapItemFormDialogTitle,size:"large",onOpenChange:function onOpenChange(isOpen){isOpen||(setEditedItem(null),setEditedArrow(null))},children:[editedItem?(0,jsx_runtime.jsx)(TopicMapItemForm.Q,{itemId:editedItem,semantics,params,parent,onSave:function onSave(newParams){var _newParams$topicMapIt,_newParams$arrowItems;updateItems(null!==(_newParams$topicMapIt=newParams.topicMapItems)&&void 0!==_newParams$topicMapIt?_newParams$topicMapIt:[]),updateArrows(null!==(_newParams$arrowItems=newParams.arrowItems)&&void 0!==_newParams$arrowItems?_newParams$arrowItems:[]),setEditedItem(null)}}):null,editedArrow?(0,jsx_runtime.jsx)(ArrowItemForm.E,{itemId:editedArrow,semantics,params,parent,onSave:function onSave(newParams){var _newParams$arrowItems2;updateArrows(null!==(_newParams$arrowItems2=newParams.arrowItems)&&void 0!==_newParams$arrowItems2?_newParams$arrowItems2:[]),setEditedArrow(null)}}):null]})]})]})};MapEditorView.displayName="MapEditorView";try{MapEditorView.displayName="MapEditorView",MapEditorView.__docgenInfo={description:"",displayName:"MapEditorView",props:{gapSize:{defaultValue:null,description:"",name:"gapSize",required:!1,type:{name:"number"}},numberOfColumns:{defaultValue:null,description:"",name:"numberOfColumns",required:!1,type:{name:"number"}},numberOfRows:{defaultValue:null,description:"",name:"numberOfRows",required:!1,type:{name:"number"}},params:{defaultValue:null,description:"",name:"params",required:!0,type:{name:"Params"}},parent:{defaultValue:null,description:"",name:"parent",required:!0,type:{name:"H5PForm"}},semantics:{defaultValue:null,description:"",name:"semantics",required:!0,type:{name:'H5PFieldCommon & H5PFieldWidgetExtension & { type: "group" | H5PFieldType.Group; widget?: string | undefined; fields: H5PField[]; isSubContent?: boolean | undefined; expanded?: boolean | undefined; }'}},setParams:{defaultValue:null,description:"",name:"setParams",required:!0,type:{name:"(updatedParams: Partial<Params>) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MapEditorView/MapEditorView.tsx#MapEditorView"]={docgenInfo:MapEditorView.__docgenInfo,name:"MapEditorView",path:"src/components/MapEditorView/MapEditorView.tsx#MapEditorView"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/TopicMapItemForm/TopicMapItemForm.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>TopicMapItemForm});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_utils_arrow_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/arrow.utils.ts"),_utils_H5P_form_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/H5P/form.utils.ts"),_SemanticsForm_SemanticsForm__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/components/SemanticsForm/SemanticsForm.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TopicMapItemForm=function TopicMapItemForm(_ref){var semantics=_ref.semantics,params=_ref.params,parent=_ref.parent,itemId=_ref.itemId,onSave=_ref.onSave,_React$useState2=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),topicMapItemsField=_React$useState2[0],setTopicMapItemsField=_React$useState2[1],_React$useState4=_slicedToArray(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),formParams=_React$useState4[0],setFormParams=_React$useState4[1];react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){var field=(0,_utils_H5P_form_utils__WEBPACK_IMPORTED_MODULE_2__.k$)(semantics);setTopicMapItemsField(field),params.topicMapItems&&setFormParams(_objectSpread(_objectSpread({},params),{},{topicMapItems:params.topicMapItems.filter((function(item){return item.id===itemId}))}))}),[itemId,params,semantics]);var onUpdate=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(newParams){var _params$topicMapItems,_params$topicMapItems2,_params$arrowItems,_params$arrowItems2;if(newParams.topicMapItems){var updatedItem=newParams.topicMapItems[0],updatedItems=null!==(_params$topicMapItems=null===(_params$topicMapItems2=params.topicMapItems)||void 0===_params$topicMapItems2?void 0:_params$topicMapItems2.map((function(item){return item.id===updatedItem.id?updatedItem:item})))&&void 0!==_params$topicMapItems?_params$topicMapItems:[],unaffectedArrows=(null===(_params$arrowItems=params.arrowItems)||void 0===_params$arrowItems?void 0:_params$arrowItems.filter((function(arrow){return arrow.startElementId!==updatedItem.id&&arrow.endElementId!==updatedItem.id})))||[],affectedArrows=(null===(_params$arrowItems2=params.arrowItems)||void 0===_params$arrowItems2?void 0:_params$arrowItems2.filter((function(arrow){return arrow.startElementId===updatedItem.id||arrow.endElementId===updatedItem.id})).map((function(arrow){return _objectSpread(_objectSpread({},arrow),{},{label:(0,_utils_arrow_utils__WEBPACK_IMPORTED_MODULE_1__.id)(arrow.startElementId,arrow.endElementId,arrow.arrowType,updatedItems)})})))||[],updatedArrows=[].concat(_toConsumableArray(unaffectedArrows),_toConsumableArray(affectedArrows));onSave(_objectSpread(_objectSpread({},newParams),{},{topicMapItems:updatedItems,arrowItems:updatedArrows}))}}),[onSave,params.arrowItems,params.topicMapItems]);return formParams&&topicMapItemsField?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(_SemanticsForm_SemanticsForm__WEBPACK_IMPORTED_MODULE_3__.G,{fields:[topicMapItemsField],params:formParams,parent,onSave:onUpdate,formClassName:"topic-map-item-form"}):null};try{TopicMapItemForm.displayName="TopicMapItemForm",TopicMapItemForm.__docgenInfo={description:"",displayName:"TopicMapItemForm",props:{semantics:{defaultValue:null,description:"",name:"semantics",required:!0,type:{name:'H5PFieldCommon & H5PFieldWidgetExtension & { type: "group" | H5PFieldType.Group; widget?: string | undefined; fields: H5PField[]; isSubContent?: boolean | undefined; expanded?: boolean | undefined; }'}},params:{defaultValue:null,description:"",name:"params",required:!0,type:{name:"Params"}},parent:{defaultValue:null,description:"",name:"parent",required:!0,type:{name:"H5PForm"}},itemId:{defaultValue:null,description:"",name:"itemId",required:!0,type:{name:"string"}},onSave:{defaultValue:null,description:"",name:"onSave",required:!0,type:{name:"(params: Params) => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TopicMapItemForm/TopicMapItemForm.tsx#TopicMapItemForm"]={docgenInfo:TopicMapItemForm.__docgenInfo,name:"TopicMapItemForm",path:"src/components/TopicMapItemForm/TopicMapItemForm.tsx#TopicMapItemForm"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/H5P/form.utils.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dk:()=>getEmptyParams,Gs:()=>fillInMissingParamsProperties,RU:()=>getArrowItemsField,k$:()=>getTopicMapItemsField,x4:()=>getBackgroundImageField});var h5p_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/h5p-utils/dist/h5p-utils.es.js");function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!==_typeof(input)||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!==_typeof(res))return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"===_typeof(key)?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var getSingleField=function getSingleField(fieldName,semantics){if(!h5p_utils__WEBPACK_IMPORTED_MODULE_0__._t.findSemanticsField)return null;var field=h5p_utils__WEBPACK_IMPORTED_MODULE_0__._t.findSemanticsField(fieldName,semantics);if(!field)throw new Error("Could not find the `".concat(fieldName,"` field"));return Array.isArray(field)?(console.error("`".concat(fieldName,"` is an array, which means that more than one field with the name was found."),field),field[0]):field},getTopicMapItemsField=function getTopicMapItemsField(semantics){return getSingleField("topicMapItems",semantics)},getArrowItemsField=function getArrowItemsField(semantics){return getSingleField("arrowItems",semantics)},getBackgroundImageField=function getBackgroundImageField(semantics){return getSingleField("gridBackgroundImage",semantics)},getEmptyParams=function getEmptyParams(){return{topicMapItems:[],arrowItems:[]}},fillInMissingParamsProperties=function fillInMissingParamsProperties(partialParams){return _objectSpread(_objectSpread({},getEmptyParams()),partialParams)}}}]);